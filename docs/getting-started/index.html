<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/bevel-operator-fabric/blog/rss.xml" title="Hyperledger Fabric Operator Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/bevel-operator-fabric/blog/atom.xml" title="Hyperledger Fabric Operator Blog Atom Feed"><title data-react-helmet="true">Getting started | Hyperledger Fabric Operator</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Getting started | Hyperledger Fabric Operator"><meta data-react-helmet="true" name="description" content="Tutorial"><meta data-react-helmet="true" property="og:description" content="Tutorial"><meta data-react-helmet="true" property="og:url" content="https://hyperledger.github.io/bevel-operator-fabric/docs/getting-started"><link data-react-helmet="true" rel="shortcut icon" href="/bevel-operator-fabric/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://hyperledger.github.io/bevel-operator-fabric/docs/getting-started"><link rel="stylesheet" href="/bevel-operator-fabric/styles.15213869.css">
<link rel="preload" href="/bevel-operator-fabric/styles.8719b551.js" as="script">
<link rel="preload" href="/bevel-operator-fabric/runtime~main.389aaa0a.js" as="script">
<link rel="preload" href="/bevel-operator-fabric/main.b66677eb.js" as="script">
<link rel="preload" href="/bevel-operator-fabric/1.1f8929dd.js" as="script">
<link rel="preload" href="/bevel-operator-fabric/58.d57f0ac2.js" as="script">
<link rel="preload" href="/bevel-operator-fabric/59.7638e283.js" as="script">
<link rel="preload" href="/bevel-operator-fabric/935f2afb.8173fafd.js" as="script">
<link rel="preload" href="/bevel-operator-fabric/57.88432d89.js" as="script">
<link rel="preload" href="/bevel-operator-fabric/d589d3a7.910c0dc1.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/bevel-operator-fabric/"><img src="/bevel-operator-fabric/img/favicon.png" alt="HLF Operator" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/bevel-operator-fabric/img/favicon.png" alt="HLF Operator" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">HLF Operator</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/bevel-operator-fabric/docs/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/hyperledger/bevel-operator-fabric" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk" style="margin-left:2px">ðŸŒ™</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk" style="margin-left:1px">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/bevel-operator-fabric/"><img src="/bevel-operator-fabric/img/favicon.png" alt="HLF Operator" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/bevel-operator-fabric/img/favicon.png" alt="HLF Operator" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">HLF Operator</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/bevel-operator-fabric/docs/">Docs</a></li><li class="menu__list-item"><a href="https://github.com/hyperledger/bevel-operator-fabric" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Operator</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/bevel-operator-fabric/docs/">Introduction</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/bevel-operator-fabric/docs/getting-started">Getting started</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Operator Guide</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/operator-guide/state-db">LevelDB / CouchDB</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/operator-guide/monitoring">Monitoring</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/operator-guide/configuration">Configuration (Affinity, NodeSelector, Tolerations)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/operator-guide/migrate-network">Migrate network</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/operator-guide/increase-resources">Increase resources</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/operator-guide/increase-storage">Increase storage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/operator-guide/renew-certificates">Renew certificates</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/operator-guide/istio">Istio set up</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/operator-guide/upgrade-hlf-operator">Upgrade HLF operator</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/operator-guide/auto-renew-certificates">Automatic renewal of certificates</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">User Guide</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/user-guide/network-config">Get a network config</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/user-guide/network-config-kubernetes">Using network config in the kubernetes cluster</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/user-guide/create-channel">Create channel</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/user-guide/install-chaincode">Install Chaincode</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/user-guide/enroll-users">Register &amp; Enroll users</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/user-guide/develop-chaincode-locally">Develop chaincode locally</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Chaincode development</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/chaincode-development/architecture">Architecture</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/chaincode-development/getting-started">Getting started</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Chaincode deployment</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/chaincode-deployment/getting-started">Getting started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/chaincode-deployment/external-chaincode-as-a-service">External chaincode as a service</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/chaincode-deployment/k8s-builder">Kubernetes chaincode builder</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Channel management</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/channel-management/getting-started">Getting started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/channel-management/manage">Manage the channel</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Kubectl Plugin</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/kubectl-plugin/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/kubectl-plugin/upgrade">Upgrade</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Identity</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/identity-crd/manage-identities">Managing identities with CRDs</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Gateway API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/gateway-api/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/gateway-api/getting-started">Getting started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/gateway-api/implementation">Implementation</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">CouchDB</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/couchdb/external-couchdb">Using external CouchDB</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/couchdb/custom-image">Using custom CouchDB image</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/reference/reference">Reference</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">GRPC Proxy</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/grpc-proxy/enable-peers">enable-peers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/grpc-proxy/enable-orderers">enable-orderers</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Operations Console</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/operations-console/getting-started">Getting started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/operations-console/adding-cas">Adding Certificate Authorities</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/operations-console/adding-peers">Adding Peers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/operations-console/adding-orderers">Adding Orderer nodes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/operations-console/adding-orgs">Adding Organizations</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Operator UI</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/operator-ui/getting-started">Getting started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/operator-ui/deploy-operator-ui">Deploy Operator UI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bevel-operator-fabric/docs/operator-ui/deploy-operator-api">Deploy Operator API</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Getting started</h1></header><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="tutorial"></a>Tutorial<a class="hash-link" href="#tutorial" title="Direct link to heading">#</a></h1><p>Resources:</p><ul><li><a href="https://www.polarsparc.com/xhtml/Hyperledger-ARM-Build.html" target="_blank" rel="noopener noreferrer">Hyperledger Fabric build ARM</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="create-kubernetes-cluster"></a>Create Kubernetes Cluster<a class="hash-link" href="#create-kubernetes-cluster" title="Direct link to heading">#</a></h2><p>To start deploying our red fabric we have to have a Kubernetes cluster. For this we will use KinD.</p><p>Ensure you have these ports available before creating the cluster:</p><ul><li>80</li><li>443</li></ul><p>If these ports are not available this tutorial will not work.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">cat</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token plain"> EOF </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> kind-config.yaml</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kind: Cluster</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">apiVersion: kind.x-k8s.io/v1alpha4</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">nodes:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">- role: control-plane</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  extraPortMappings:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  - containerPort: </span><span class="token number" style="color:rgb(247, 140, 108)">30949</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    hostPort: </span><span class="token number" style="color:rgb(247, 140, 108)">80</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  - containerPort: </span><span class="token number" style="color:rgb(247, 140, 108)">30950</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    hostPort: </span><span class="token number" style="color:rgb(247, 140, 108)">443</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">EOF</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kind create cluster --config</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./kind-config.yaml</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="install-kubernetes-operator"></a>Install Kubernetes operator<a class="hash-link" href="#install-kubernetes-operator" title="Direct link to heading">#</a></h2><p>In this step we are going to install the kubernetes operator for Fabric, this will install:</p><ul><li>CRD (Custom Resource Definitions) to deploy Certification Fabric Peers, Orderers and Authorities</li><li>Deploy the program to deploy the nodes in Kubernetes</li></ul><p>To install helm: <a href="https://helm.sh/docs/intro/install/" target="_blank" rel="noopener noreferrer">https://helm.sh/docs/intro/install/</a></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">helm repo </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> kfs https://kfsoftware.github.io/hlf-helm-charts --force-update</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">helm </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> hlf-operator --version</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1.8</span><span class="token plain">.0 kfs/hlf-operator</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="install-the-kubectl-plugin"></a>Install the Kubectl plugin<a class="hash-link" href="#install-the-kubectl-plugin" title="Direct link to heading">#</a></h3><p>To install the kubectl plugin, you must first install Krew:
<a href="https://krew.sigs.k8s.io/docs/user-guide/setup/install/" target="_blank" rel="noopener noreferrer">https://krew.sigs.k8s.io/docs/user-guide/setup/install/</a></p><p>Afterwards, the plugin can be installed with the following command:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl krew </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> hlf</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="install-istio"></a>Install Istio<a class="hash-link" href="#install-istio" title="Direct link to heading">#</a></h3><p>Install Istio binaries on the machine:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -L https://istio.io/downloadIstio </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">sh</span><span class="token plain"> -</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Install Istio on the Kubernetes cluster:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl create namespace istio-system</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">istioctl operator init</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl apply -f - </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token string" style="color:rgb(195, 232, 141)">EOF</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">apiVersion: install.istio.io/v1alpha1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">kind: IstioOperator</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">metadata:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  name: istio-gateway</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  namespace: istio-system</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">spec:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  addonComponents:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    grafana:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      enabled: false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    kiali:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      enabled: false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    prometheus:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      enabled: false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    tracing:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      enabled: false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  components:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    ingressGateways:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      - enabled: true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        k8s:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">          hpaSpec:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">            minReplicas: 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">          resources:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">            limits:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">              cpu: 500m</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">              memory: 512Mi</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">            requests:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">              cpu: 100m</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">              memory: 128Mi</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">          service:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">            ports:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">              - name: http</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">                port: 80</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">                targetPort: 8080</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">                nodePort: 30949</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">              - name: https</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">                port: 443</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">                targetPort: 8443</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">                nodePort: 30950</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">            type: NodePort</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        name: istio-ingressgateway</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    pilot:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      enabled: true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      k8s:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        hpaSpec:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">          minReplicas: 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        resources:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">          limits:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">            cpu: 300m</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">            memory: 512Mi</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">          requests:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">            cpu: 100m</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">            memory: 128Mi</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  meshConfig:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    accessLogFile: /dev/stdout</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    enableTracing: false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    outboundTrafficPolicy:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      mode: ALLOW_ANY</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  profile: default</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="display:inline-block;color:rgb(195, 232, 141)">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">EOF</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="deploy-a-peer-organization"></a>Deploy a <code>Peer</code> organization<a class="hash-link" href="#deploy-a-peer-organization" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="environment-variables-for-amd-default"></a>Environment Variables for AMD (Default)<a class="hash-link" href="#environment-variables-for-amd-default" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">PEER_IMAGE</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">hyperledger/fabric-peer</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">PEER_VERSION</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">2.4</span><span class="token plain">.6</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">ORDERER_IMAGE</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">hyperledger/fabric-orderer</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">ORDERER_VERSION</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">2.4</span><span class="token plain">.6</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="environment-variables-for-arm-mac-m1"></a>Environment Variables for ARM (Mac M1)<a class="hash-link" href="#environment-variables-for-arm-mac-m1" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">PEER_IMAGE</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">bswamina/fabric-peer</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">PEER_VERSION</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">2.4</span><span class="token plain">.6</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">ORDERER_IMAGE</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">bswamina/fabric-orderer</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">ORDERER_VERSION</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">2.4</span><span class="token plain">.6</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="configurar-dns-interno"></a>Configurar DNS interno<a class="hash-link" href="#configurar-dns-interno" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token assign-left variable" style="color:rgb(191, 199, 213)">CLUSTER_IP</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable" style="color:rgb(191, 199, 213)">kubectl -n istio-system get svc istio-ingressgateway -o json </span><span class="token variable operator" style="color:rgb(137, 221, 255)">|</span><span class="token variable" style="color:rgb(191, 199, 213)"> jq -r .spec.clusterIP</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl apply -f - </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token string" style="color:rgb(195, 232, 141)">EOF</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">kind: ConfigMap</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">apiVersion: v1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">metadata:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  name: coredns</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  namespace: kube-system</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">data:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  Corefile: |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    .:53 {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        errors</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        health {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">           lameduck 5s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        rewrite name regex (.*)\.localho\.st host.ingress.internal</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        hosts {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">          </span><span class="token string variable" style="color:rgb(191, 199, 213)">${CLUSTER_IP}</span><span class="token string" style="color:rgb(195, 232, 141)"> host.ingress.internal</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">          fallthrough</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        ready</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        kubernetes cluster.local in-addr.arpa ip6.arpa {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">           pods insecure</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">           fallthrough in-addr.arpa ip6.arpa</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">           ttl 30</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        prometheus :9153</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        forward . /etc/resolv.conf {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">           max_concurrent 1000</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        cache 30</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        loop</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        reload</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        loadbalance</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">EOF</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="deploy-a-certificate-authority"></a>Deploy a certificate authority<a class="hash-link" href="#deploy-a-certificate-authority" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf ca create --storage-class</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">standard --capacity</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">1Gi --name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1-ca </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --enroll-id</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">enroll --enroll-pw</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">enrollpw --hosts</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1-ca.localho.st --istio-port</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">443</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl </span><span class="token function" style="color:rgb(130, 170, 255)">wait</span><span class="token plain"> --timeout</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">180s --for</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">condition</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">Running fabriccas.hlf.kungfusoftware.es --all</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Check that the certification authority is deployed and works:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -k https://org1-ca.localho.st:443/cainfo</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Register a user in the certification authority of the peer organization (Org1MSP)</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># register user in CA for peers</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf ca register --name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1-ca --user</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">peer --secret</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">peerpw --type</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">peer </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> --enroll-id enroll --enroll-secret</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">enrollpw --mspid Org1MSP</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="deploy-a-peer"></a>Deploy a peer<a class="hash-link" href="#deploy-a-peer" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf peer create --statedb</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">couchdb --image</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$PEER_IMAGE</span><span class="token plain"> --version</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$PEER_VERSION</span><span class="token plain"> --storage-class</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">standard --enroll-id</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">peer --mspid</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">Org1MSP </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        --enroll-pw</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">peerpw --capacity</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">5Gi --name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1-peer0 --ca-name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1-ca.default </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        --hosts</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">peer0-org1.localho.st --istio-port</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">443</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf peer create --statedb</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">couchdb --image</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$PEER_IMAGE</span><span class="token plain"> --version</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$PEER_VERSION</span><span class="token plain"> --storage-class</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">standard --enroll-id</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">peer --mspid</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">Org1MSP </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        --enroll-pw</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">peerpw --capacity</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">5Gi --name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1-peer1 --ca-name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1-ca.default </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        --hosts</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">peer1-org1.localho.st --istio-port</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">443</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl </span><span class="token function" style="color:rgb(130, 170, 255)">wait</span><span class="token plain"> --timeout</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">180s --for</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">condition</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">Running fabricpeers.hlf.kungfusoftware.es --all</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Check that the peer is deployed and works:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -vik https://peer0-org1.localho.st:443</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="deploy-an-orderer-organization"></a>Deploy an <code>Orderer</code> organization<a class="hash-link" href="#deploy-an-orderer-organization" title="Direct link to heading">#</a></h2><p>To deploy an <code>Orderer</code> organization we have to:</p><ol><li>Create a certification authority</li><li>Register user <code>orderer</code> with password <code>ordererpw</code></li><li>Create orderer</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="create-the-certification-authority"></a>Create the certification authority<a class="hash-link" href="#create-the-certification-authority" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf ca create --storage-class</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">standard --capacity</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">1Gi --name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ord-ca </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --enroll-id</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">enroll --enroll-pw</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">enrollpw --hosts</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ord-ca.localho.st --istio-port</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">443</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl </span><span class="token function" style="color:rgb(130, 170, 255)">wait</span><span class="token plain"> --timeout</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">180s --for</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">condition</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">Running fabriccas.hlf.kungfusoftware.es --all</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Check that the certification authority is deployed and works:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -vik https://ord-ca.localho.st:443/cainfo</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="register-user-orderer"></a>Register user <code>orderer</code><a class="hash-link" href="#register-user-orderer" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf ca register --name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ord-ca --user</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">orderer --secret</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ordererpw </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --type</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">orderer --enroll-id enroll --enroll-secret</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">enrollpw --mspid</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">OrdererMSP --ca-url</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://ord-ca.localho.st:443&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="deploy-orderer"></a>Deploy orderer<a class="hash-link" href="#deploy-orderer" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf ordnode create --image</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$ORDERER_IMAGE</span><span class="token plain"> --version</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$ORDERER_VERSION</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --storage-class</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">standard --enroll-id</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">orderer --mspid</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">OrdererMSP </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --enroll-pw</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ordererpw --capacity</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">2Gi --name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ord-node1 --ca-name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ord-ca.default </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --hosts</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">orderer0-ord.localho.st --istio-port</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">443</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl </span><span class="token function" style="color:rgb(130, 170, 255)">wait</span><span class="token plain"> --timeout</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">180s --for</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">condition</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">Running fabricorderernodes.hlf.kungfusoftware.es --all</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Check that the orderer is running:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get pods</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -vik https://orderer0-ord.localho.st:443</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="prepare-connection-string-to-interact-with-orderer"></a>Prepare connection string to interact with orderer<a class="hash-link" href="#prepare-connection-string-to-interact-with-orderer" title="Direct link to heading">#</a></h2><p>To prepare the connection string, we have to:</p><ul><li>Get the connection string without users</li><li>Register a user in the certification authority for signature</li><li>Get the certificates using the user created above</li><li>Attach the user to the connection string</li></ul><ol><li>Get the connection string without users</li></ol><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf inspect --output ordservice.yaml -o OrdererMSP</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ol start="2"><li>Register a user in the TLS certification authority</li></ol><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf ca register --name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ord-ca --user</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">admin --secret</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">adminpw </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --type</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">admin --enroll-id enroll --enroll-secret</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">enrollpw --mspid</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">OrdererMSP</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ol start="3"><li>Get the certificates using the certificate</li></ol><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf ca enroll --name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ord-ca --user</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">admin --secret</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">adminpw --mspid OrdererMSP </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        --ca-name ca  --output admin-ordservice.yaml</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ol start="4"><li>Attach the user to the connection string</li></ol><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf utils adduser --userPath=admin-ordservice.yaml --config=ordservice.yaml --username=admin --mspid=OrdererMSP</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="create-channel"></a>Create channel<a class="hash-link" href="#create-channel" title="Direct link to heading">#</a></h2><p>To create the channel we need to first create the wallet secret, which will contain the identities used by the operator to manage the channel</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="register-and-enrolling-orderermsp-identity"></a>Register and enrolling OrdererMSP identity<a class="hash-link" href="#register-and-enrolling-orderermsp-identity" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># register</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf ca register --name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ord-ca --user</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">admin --secret</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">adminpw </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --type</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">admin --enroll-id enroll --enroll-secret</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">enrollpw --mspid</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">OrdererMSP</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># enroll</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf ca enroll --name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ord-ca --namespace</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">default </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --user</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">admin --secret</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">adminpw --mspid OrdererMSP </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --ca-name tlsca  --output orderermsp.yaml</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="register-and-enrolling-org1msp-identity"></a>Register and enrolling Org1MSP identity<a class="hash-link" href="#register-and-enrolling-org1msp-identity" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># register</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf ca register --name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1-ca --namespace</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">default --user</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">admin --secret</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">adminpw </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --type</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">admin --enroll-id enroll --enroll-secret</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">enrollpw --mspid</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">Org1MSP</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># enroll</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf ca enroll --name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1-ca --namespace</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">default </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --user</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">admin --secret</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">adminpw --mspid Org1MSP </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --ca-name ca  --output org1msp.yaml</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="create-the-secret"></a>Create the secret<a class="hash-link" href="#create-the-secret" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl create secret generic wallet --namespace</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">default </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        --from-file</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1msp.yaml</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token environment constant" style="color:rgb(130, 170, 255)">$PWD</span><span class="token plain">/org1msp.yaml </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        --from-file</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">orderermsp.yaml</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token environment constant" style="color:rgb(130, 170, 255)">$PWD</span><span class="token plain">/orderermsp.yaml</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="create-main-channel"></a>Create main channel<a class="hash-link" href="#create-main-channel" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">PEER_ORG_SIGN_CERT</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable" style="color:rgb(191, 199, 213)">kubectl get fabriccas org1-ca -o</span><span class="token variable operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">jsonpath</span><span class="token variable operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable string" style="color:rgb(195, 232, 141)">&#x27;{.status.ca_cert}&#x27;</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">PEER_ORG_TLS_CERT</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable" style="color:rgb(191, 199, 213)">kubectl get fabriccas org1-ca -o</span><span class="token variable operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">jsonpath</span><span class="token variable operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable string" style="color:rgb(195, 232, 141)">&#x27;{.status.tlsca_cert}&#x27;</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">IDENT_8</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable builtin class-name" style="color:rgb(255, 203, 107)">printf</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable string" style="color:rgb(195, 232, 141)">&quot;%8s&quot;</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable string" style="color:rgb(195, 232, 141)">&quot;&quot;</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">ORDERER_TLS_CERT</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable" style="color:rgb(191, 199, 213)">kubectl get fabriccas ord-ca -o</span><span class="token variable operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">jsonpath</span><span class="token variable operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable string" style="color:rgb(195, 232, 141)">&#x27;{.status.tlsca_cert}&#x27;</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable operator" style="color:rgb(137, 221, 255)">|</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable function" style="color:rgb(130, 170, 255)">sed</span><span class="token variable" style="color:rgb(191, 199, 213)"> -e </span><span class="token variable string" style="color:rgb(195, 232, 141)">&quot;s/^/</span><span class="token variable string variable" style="color:rgb(191, 199, 213)">${IDENT_8}</span><span class="token variable string" style="color:rgb(195, 232, 141)">/&quot;</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">ORDERER0_TLS_CERT</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable" style="color:rgb(191, 199, 213)">kubectl get fabricorderernodes ord-node1 -o</span><span class="token variable operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">jsonpath</span><span class="token variable operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable string" style="color:rgb(195, 232, 141)">&#x27;{.status.tlsCert}&#x27;</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable operator" style="color:rgb(137, 221, 255)">|</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable function" style="color:rgb(130, 170, 255)">sed</span><span class="token variable" style="color:rgb(191, 199, 213)"> -e </span><span class="token variable string" style="color:rgb(195, 232, 141)">&quot;s/^/</span><span class="token variable string variable" style="color:rgb(191, 199, 213)">${IDENT_8}</span><span class="token variable string" style="color:rgb(195, 232, 141)">/&quot;</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl apply -f - </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token string" style="color:rgb(195, 232, 141)">EOF</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">apiVersion: hlf.kungfusoftware.es/v1alpha1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">kind: FabricMainChannel</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">metadata:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  name: demo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">spec:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  name: demo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  adminOrdererOrganizations:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    - mspID: OrdererMSP</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  adminPeerOrganizations:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    - mspID: Org1MSP</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  channelConfig:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    application:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      acls: null</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      capabilities:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        - V2_0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      policies: null</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    capabilities:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      - V2_0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    orderer:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      batchSize:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        absoluteMaxBytes: 1048576</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        maxMessageCount: 10</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        preferredMaxBytes: 524288</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      batchTimeout: 2s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      capabilities:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        - V2_0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      etcdRaft:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        options:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">          electionTick: 10</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">          heartbeatTick: 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">          maxInflightBlocks: 5</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">          snapshotIntervalSize: 16777216</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">          tickInterval: 500ms</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      ordererType: etcdraft</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      policies: null</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      state: STATE_NORMAL</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    policies: null</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  externalOrdererOrganizations: []</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  peerOrganizations:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    - mspID: Org1MSP</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      caName: &quot;org1-ca&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      caNamespace: &quot;default&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  identities:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    OrdererMSP:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      secretKey: orderermsp.yaml</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      secretName: wallet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      secretNamespace: default</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    Org1MSP:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      secretKey: org1msp.yaml</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      secretName: wallet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      secretNamespace: default</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  externalPeerOrganizations: []</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  ordererOrganizations:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    - caName: &quot;ord-ca&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      caNamespace: &quot;default&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      externalOrderersToJoin:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        - host: ord-node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">          port: 7053</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      mspID: OrdererMSP</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      ordererEndpoints:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        - ord-node1:7050</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      orderersToJoin: []</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  orderers:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    - host: ord-node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      port: 7050</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      tlsCert: |-</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)"></span><span class="token string variable" style="color:rgb(191, 199, 213)">${ORDERER0_TLS_CERT}</span><span class="token string" style="color:rgb(195, 232, 141)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="display:inline-block;color:rgb(195, 232, 141)">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">EOF</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="join-peer-to-the-channel"></a>Join peer to the channel<a class="hash-link" href="#join-peer-to-the-channel" title="Direct link to heading">#</a></h2><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">IDENT_8</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable builtin class-name" style="color:rgb(255, 203, 107)">printf</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable string" style="color:rgb(195, 232, 141)">&quot;%8s&quot;</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable string" style="color:rgb(195, 232, 141)">&quot;&quot;</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">ORDERER0_TLS_CERT</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable" style="color:rgb(191, 199, 213)">kubectl get fabricorderernodes ord-node1 -o</span><span class="token variable operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">jsonpath</span><span class="token variable operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable string" style="color:rgb(195, 232, 141)">&#x27;{.status.tlsCert}&#x27;</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable operator" style="color:rgb(137, 221, 255)">|</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable function" style="color:rgb(130, 170, 255)">sed</span><span class="token variable" style="color:rgb(191, 199, 213)"> -e </span><span class="token variable string" style="color:rgb(195, 232, 141)">&quot;s/^/</span><span class="token variable string variable" style="color:rgb(191, 199, 213)">${IDENT_8}</span><span class="token variable string" style="color:rgb(195, 232, 141)">/&quot;</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl apply -f - </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token string" style="color:rgb(195, 232, 141)">EOF</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">apiVersion: hlf.kungfusoftware.es/v1alpha1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">kind: FabricFollowerChannel</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">metadata:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  name: demo-org1msp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">spec:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  anchorPeers:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    - host: org1-peer0.default</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      port: 7051</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  hlfIdentity:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    secretKey: org1msp.yaml</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    secretName: wallet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    secretNamespace: default</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  mspId: Org1MSP</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  name: demo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  externalPeersToJoin: []</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  orderers:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    - certificate: |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)"></span><span class="token string variable" style="color:rgb(191, 199, 213)">${ORDERER0_TLS_CERT}</span><span class="token string" style="color:rgb(195, 232, 141)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      url: grpcs://ord-node1.default:7050</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  peersToJoin:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    - name: org1-peer0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      namespace: default</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    - name: org1-peer1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">      namespace: default</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">EOF</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="install-a-chaincode"></a>Install a chaincode<a class="hash-link" href="#install-a-chaincode" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="prepare-connection-string-for-a-peer"></a>Prepare connection string for a peer<a class="hash-link" href="#prepare-connection-string-for-a-peer" title="Direct link to heading">#</a></h3><p>To prepare the connection string, we have to:</p><ol><li><p>Get connection string without users for organization Org1MSP and OrdererMSP</p></li><li><p>Register a user in the certification authority for signing (register)</p></li><li><p>Obtain the certificates using the previously created user (enroll)</p></li><li><p>Attach the user to the connection string</p></li><li><p>Get connection string without users for organization Org1MSP and OrdererMSP</p></li></ol><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf inspect --output org1.yaml -o Org1MSP -o OrdererMSP</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ol start="2"><li>Register a user in the certification authority for signing</li></ol><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf ca register --name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1-ca --user</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">admin --secret</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">adminpw --type</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">admin </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> --enroll-id enroll --enroll-secret</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">enrollpw --mspid Org1MSP  </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ol start="3"><li>Get the certificates using the user created above</li></ol><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf ca enroll --name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1-ca --user</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">admin --secret</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">adminpw --mspid Org1MSP </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        --ca-name ca  --output peer-org1.yaml</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ol start="4"><li>Attach the user to the connection string</li></ol><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf utils adduser --userPath</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">peer-org1.yaml --config</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1.yaml --username</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">admin --mspid</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">Org1MSP</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="create-metadata-file"></a>Create metadata file<a class="hash-link" href="#create-metadata-file" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># remove the code.tar.gz chaincode.tgz if they exist</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">rm</span><span class="token plain"> code.tar.gz chaincode.tgz</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">CHAINCODE_NAME</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">asset</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">CHAINCODE_LABEL</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">asset</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">cat</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token plain"> METADATA-EOF </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;metadata.json&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;type&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ccaas&quot;</span><span class="token plain">,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;label&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token string variable" style="color:rgb(191, 199, 213)">${CHAINCODE_LABEL}</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">METADATA-EOF</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">## chaincode as a service</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="prepare-connection-file"></a>Prepare connection file<a class="hash-link" href="#prepare-connection-file" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">cat</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;connection.json&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token string" style="color:rgb(195, 232, 141)">CONN_EOF</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  &quot;address&quot;: &quot;</span><span class="token string variable" style="color:rgb(191, 199, 213)">${CHAINCODE_NAME}</span><span class="token string" style="color:rgb(195, 232, 141)">:7052&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  &quot;dial_timeout&quot;: &quot;10s&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  &quot;tls_required&quot;: false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">CONN_EOF</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">tar</span><span class="token plain"> cfz code.tar.gz connection.json</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">tar</span><span class="token plain"> cfz chaincode.tgz metadata.json code.tar.gz</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">PACKAGE_ID</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable" style="color:rgb(191, 199, 213)">kubectl hlf chaincode calculatepackageid --path</span><span class="token variable operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">chaincode.tgz --language</span><span class="token variable operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">node --label</span><span class="token variable operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$CHAINCODE_LABEL</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;PACKAGE_ID=</span><span class="token string variable" style="color:rgb(191, 199, 213)">$PACKAGE_ID</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf chaincode </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> --path</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./chaincode.tgz </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --config</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1.yaml --language</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">golang --label</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$CHAINCODE_LABEL</span><span class="token plain"> --user</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">admin --peer</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1-peer0.default</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf chaincode </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> --path</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./chaincode.tgz </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --config</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1.yaml --language</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">golang --label</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$CHAINCODE_LABEL</span><span class="token plain"> --user</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">admin --peer</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1-peer1.default</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="deploy-chaincode-container-on-cluster"></a>Deploy chaincode container on cluster<a class="hash-link" href="#deploy-chaincode-container-on-cluster" title="Direct link to heading">#</a></h2><p>The following command will create or update the CRD based on the packageID, chaincode name, and docker image.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf externalchaincode </span><span class="token function" style="color:rgb(130, 170, 255)">sync</span><span class="token plain"> --image</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">kfsoftware/chaincode-external:latest </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$CHAINCODE_NAME</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --namespace</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">default </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --package-id</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$PACKAGE_ID</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --tls-required</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">false </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --replicas</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="check-installed-chaincodes"></a>Check installed chaincodes<a class="hash-link" href="#check-installed-chaincodes" title="Direct link to heading">#</a></h2><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf chaincode queryinstalled --config</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1.yaml --user</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">admin --peer</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1-peer0.default</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="approve-chaincode"></a>Approve chaincode<a class="hash-link" href="#approve-chaincode" title="Direct link to heading">#</a></h2><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">SEQUENCE</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">VERSION</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;1.0&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf chaincode approveformyorg --config</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1.yaml --user</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">admin --peer</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1-peer0.default </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --package-id</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$PACKAGE_ID</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --version </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token string variable" style="color:rgb(191, 199, 213)">$VERSION</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token plain"> --sequence </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token string variable" style="color:rgb(191, 199, 213)">$SEQUENCE</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token plain"> --name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">asset </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --policy</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;OR(&#x27;Org1MSP.member&#x27;)&quot;</span><span class="token plain"> --channel</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">demo</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="commit-chaincode"></a>Commit chaincode<a class="hash-link" href="#commit-chaincode" title="Direct link to heading">#</a></h2><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf chaincode commit --config</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1.yaml --user</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">admin --mspid</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">Org1MSP </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --version </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token string variable" style="color:rgb(191, 199, 213)">$VERSION</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token plain"> --sequence </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token string variable" style="color:rgb(191, 199, 213)">$SEQUENCE</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token plain"> --name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">asset </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --policy</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;OR(&#x27;Org1MSP.member&#x27;)&quot;</span><span class="token plain"> --channel</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">demo</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="invoke-a-transaction-on-the-channel"></a>Invoke a transaction on the channel<a class="hash-link" href="#invoke-a-transaction-on-the-channel" title="Direct link to heading">#</a></h2><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf chaincode invoke --config</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1.yaml </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --user</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">admin --peer</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1-peer0.default </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --chaincode</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">asset --channel</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">demo </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --fcn</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">initLedger -a </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;[]&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="query-assets-in-the-channel"></a>Query assets in the channel<a class="hash-link" href="#query-assets-in-the-channel" title="Direct link to heading">#</a></h2><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl hlf chaincode query --config</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1.yaml </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --user</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">admin --peer</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1-peer0.default </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --chaincode</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">asset --channel</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">demo </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --fcn</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">GetAllAssets -a </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;[]&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>At this point, you should have:</p><ul><li>Ordering service with 1 nodes and a CA</li><li>Peer organization with a peer and a CA</li><li>A channel <strong>demo</strong></li><li>A chaincode install in peer0</li><li>A chaincode approved and committed</li></ul><p>If something went wrong or didn&#x27;t work, please, open an issue.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="cleanup-the-environment"></a>Cleanup the environment<a class="hash-link" href="#cleanup-the-environment" title="Direct link to heading">#</a></h2><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl delete fabricorderernodes.hlf.kungfusoftware.es --all-namespaces --all</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl delete fabricpeers.hlf.kungfusoftware.es --all-namespaces --all</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl delete fabriccas.hlf.kungfusoftware.es --all-namespaces --all</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl delete fabricchaincode.hlf.kungfusoftware.es --all-namespaces --all</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="troubleshooting"></a>Troubleshooting<a class="hash-link" href="#troubleshooting" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="chaincode-installationbuild-error"></a>Chaincode installation/build error<a class="hash-link" href="#chaincode-installationbuild-error" title="Direct link to heading">#</a></h3><p>Chaincode installation/build can fail due to unsupported local kubertenes version such as <a href="https://github.com/kubernetes/minikube" target="_blank" rel="noopener noreferrer">minikube</a>.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-shell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ kubectl hlf chaincode </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> --path</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./fixtures/chaincodes/fabcar/go </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        --config</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1.yaml --language</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">golang --label</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">fabcar --user</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">admin --peer</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">org1-peer0.default</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Error: Transaction processing </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> endorser </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">192.168</span><span class="token plain">.49.2:31278</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">: Chaincode status Code: </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">500</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> UNKNOWN.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Description: failed to invoke backing implementation of </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;InstallChaincode&#x27;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> could not build chaincode:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">external builder failed: external builder failed to build: external builder </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;my-golang-builder&#x27;</span><span class="token plain"> failed:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">exit</span><span class="token plain"> status </span><span class="token number" style="color:rgb(247, 140, 108)">1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>If your purpose is to test the hlf-operator please consider to switch to <a href="https://github.com/kubernetes-sigs/kind" target="_blank" rel="noopener noreferrer">kind</a> that is tested and supported.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/hyperledger/bevel-operator-fabric/edit/master/website/docs/getting-started.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/bevel-operator-fabric/docs/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Introduction</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/bevel-operator-fabric/docs/operator-guide/state-db"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">LevelDB / CouchDB Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#create-kubernetes-cluster" class="table-of-contents__link">Create Kubernetes Cluster</a></li><li><a href="#install-kubernetes-operator" class="table-of-contents__link">Install Kubernetes operator</a><ul><li><a href="#install-the-kubectl-plugin" class="table-of-contents__link">Install the Kubectl plugin</a></li><li><a href="#install-istio" class="table-of-contents__link">Install Istio</a></li></ul></li><li><a href="#deploy-a-peer-organization" class="table-of-contents__link">Deploy a <code>Peer</code> organization</a><ul><li><a href="#environment-variables-for-amd-default" class="table-of-contents__link">Environment Variables for AMD (Default)</a></li><li><a href="#environment-variables-for-arm-mac-m1" class="table-of-contents__link">Environment Variables for ARM (Mac M1)</a></li><li><a href="#configurar-dns-interno" class="table-of-contents__link">Configurar DNS interno</a></li><li><a href="#deploy-a-certificate-authority" class="table-of-contents__link">Deploy a certificate authority</a></li><li><a href="#deploy-a-peer" class="table-of-contents__link">Deploy a peer</a></li></ul></li><li><a href="#deploy-an-orderer-organization" class="table-of-contents__link">Deploy an <code>Orderer</code> organization</a><ul><li><a href="#create-the-certification-authority" class="table-of-contents__link">Create the certification authority</a></li><li><a href="#register-user-orderer" class="table-of-contents__link">Register user <code>orderer</code></a></li><li><a href="#deploy-orderer" class="table-of-contents__link">Deploy orderer</a></li></ul></li><li><a href="#prepare-connection-string-to-interact-with-orderer" class="table-of-contents__link">Prepare connection string to interact with orderer</a></li><li><a href="#create-channel" class="table-of-contents__link">Create channel</a><ul><li><a href="#register-and-enrolling-orderermsp-identity" class="table-of-contents__link">Register and enrolling OrdererMSP identity</a></li><li><a href="#register-and-enrolling-org1msp-identity" class="table-of-contents__link">Register and enrolling Org1MSP identity</a></li><li><a href="#create-the-secret" class="table-of-contents__link">Create the secret</a></li><li><a href="#create-main-channel" class="table-of-contents__link">Create main channel</a></li></ul></li><li><a href="#join-peer-to-the-channel" class="table-of-contents__link">Join peer to the channel</a></li><li><a href="#install-a-chaincode" class="table-of-contents__link">Install a chaincode</a><ul><li><a href="#prepare-connection-string-for-a-peer" class="table-of-contents__link">Prepare connection string for a peer</a></li><li><a href="#create-metadata-file" class="table-of-contents__link">Create metadata file</a></li><li><a href="#prepare-connection-file" class="table-of-contents__link">Prepare connection file</a></li></ul></li><li><a href="#deploy-chaincode-container-on-cluster" class="table-of-contents__link">Deploy chaincode container on cluster</a></li><li><a href="#check-installed-chaincodes" class="table-of-contents__link">Check installed chaincodes</a></li><li><a href="#approve-chaincode" class="table-of-contents__link">Approve chaincode</a></li><li><a href="#commit-chaincode" class="table-of-contents__link">Commit chaincode</a></li><li><a href="#invoke-a-transaction-on-the-channel" class="table-of-contents__link">Invoke a transaction on the channel</a></li><li><a href="#query-assets-in-the-channel" class="table-of-contents__link">Query assets in the channel</a></li><li><a href="#cleanup-the-environment" class="table-of-contents__link">Cleanup the environment</a></li><li><a href="#troubleshooting" class="table-of-contents__link">Troubleshooting</a><ul><li><a href="#chaincode-installationbuild-error" class="table-of-contents__link">Chaincode installation/build error</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/bevel-operator-fabric/docs/">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/bevel-operator-fabric/docs/ca/">Certificate Authority</a></li><li class="footer__item"><a class="footer__link-item" href="/bevel-operator-fabric/docs/peer/">Peer</a></li><li class="footer__item"><a class="footer__link-item" href="/bevel-operator-fabric/docs/orderer/">Ordering Service</a></li><li class="footer__item"><a class="footer__link-item" href="/bevel-operator-fabric/docs/kubectl-plugin/installation">Kubectl Plugin</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/bevel-operator-fabric" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://github.com/hyperledger/bevel-operator-fabric/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github Issues</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/hyperledger/bevel-operator-fabric" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 HLF Operator, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/bevel-operator-fabric/styles.8719b551.js"></script>
<script src="/bevel-operator-fabric/runtime~main.389aaa0a.js"></script>
<script src="/bevel-operator-fabric/main.b66677eb.js"></script>
<script src="/bevel-operator-fabric/1.1f8929dd.js"></script>
<script src="/bevel-operator-fabric/58.d57f0ac2.js"></script>
<script src="/bevel-operator-fabric/59.7638e283.js"></script>
<script src="/bevel-operator-fabric/935f2afb.8173fafd.js"></script>
<script src="/bevel-operator-fabric/57.88432d89.js"></script>
<script src="/bevel-operator-fabric/d589d3a7.910c0dc1.js"></script>
</body>
</html>